version: 2.1

executors:
  linux_builder:
    docker:
      - image: cimg/base:2022.09

jobs:
  build:
    executor: linux_builder
    steps:
      - checkout
      - run:
          name: Add Swap Memory
          command: |
            sudo fallocate -l 4G /swapfile || echo "fallocate failed"
            sudo chmod 600 /swapfile || echo "chmod failed"
            sudo mkswap /swapfile || echo "mkswap failed"
            sudo swapon /swapfile || echo "swapon failed"
            free -h || echo "free command failed"
      - run:
           name: Execute shell
           command: "bash buildrom.sh"
workflows:
  version: 2
  build_and_test:
    jobs:
      - build

